button_card_templates: !include button_card_templates.yaml

views:
  - type: custom:grid-layout
    path: 0
    layout:
      #default
      grid-gap: var(--custom-layout-card-padding)
      grid-template-columns: repeat(4, 1fr) 0
      grid-template-rows: 0 repeat(2, fit-content(100%)) 0fr
      grid-template-areas: |
        "sidebar  .           .        .        ."
        "sidebar  livingroom  kitchen  bedroom  ."
        "sidebar  media       other    home     ."
        "sidebar  footer      footer   footer   ."
      mediaquery:
        #phone
        "(max-width: 800px)":
          grid-gap: calc(var(--custom-layout-card-padding) * 1.7)
          grid-template-columns: 0 repeat(2, 1fr) 0
          grid-template-rows: 0 repeat(5, fit-content(100%)) 0fr
          grid-template-areas: |
            ".  .           .        ."
            ".  sidebar     sidebar  ."
            ".  livingroom  bedroom  ."
            ".  kitchen     other    ."
            ".  media       home     ."
            ".  footer      footer   ."
            ".  .           .        ."
        #portrait
        "(max-width: 1200px)":
          grid-gap: var(--custom-layout-card-padding)
          grid-template-columns: repeat(3, 1fr) 0
          grid-template-rows: 0 repeat(3, fit-content(100%)) 0fr
          grid-template-areas: |
            "sidebar  .           .        ."
            "sidebar  livingroom  bedroom  ."
            "sidebar  kitchen     other    ."
            "sidebar  media       home     ."
            "sidebar  footer      footer   ."
            "sidebar  .           .        ."
    cards:
      - type: custom:button-card
        styles: #extra_styles fix
          card:
            - display: none

      #################################################
      #                                               #
      #                    SIDEBAR                    #
      #                                               #
      #################################################

      - type: vertical-stack
        view_layout:
          grid-area: sidebar
        cards:
          - type: custom:button-card
            entity: sensor.template_sidebar
            template: sidebar_template

          # - type: conditional
          #   conditions:
          #     - entity: input_boolean.laundry_display
          #       state: "on"
          #   card:
          #     type: custom:button-card
          #     entity: timer.laundry
          #     template: laundry

          # - type: grid
          # - type: horizontal-stack
          #   cards:

      # Container: Selectable Room
          - type: custom:button-card
            name: Master Light Control
            template: container
            custom_fields:
              buttons:
                card:
                  type: vertical-stack
                  cards:
                    - type: entities
                      show_header_toggle: false
                      entities:
                        - entity: input_select.selectable_room
                          name: "Select Room.."
                          icon: "mdi:floor-plan"

                        - type: "custom:slider-entity-row"
                          entity: light.all_lights
                          step: 1

                        - type: "custom:rgb-light-card"
                          entity: light.all_lights
                          justify: "around"
                          colors:
                            - label: "Morning"
                              brightness: 181
                              color_temp: 200
                            - label: "Evening"
                              brightness: 90
                              color_temp: 370
                            - hs_color: [286, 97]
                            - hs_color: [0, 100]
                            - hs_color: [220, 100]
                            - type: call-service
                              label: "Off"
                              icon_color: rgba(255, 0, 0, 0)
                              service: light.turn_off
                              service_data:
                                entity_id: light.all_lights

      # Conditional: Selectable Room

          - type: conditional
            conditions:
              - entity: input_select.selectable_room
                state: All
            card:
              type: custom:button-card
              entity: light.all_lights
              tap_action:
                action: none
              template:
                - light_selected
                - icon_hue

          - type: conditional
            conditions:
              - entity: input_select.selectable_room
                state: Living Room
            card:
              type: custom:button-card
              entity: light.living_room_lights
              template:
                - light
                - icon_hue

          - type: conditional
            conditions:
              - entity: input_select.selectable_room
                state: Kitchen
            card:
              type: custom:button-card
              entity: light.kitchen_lights
              template:
                - light
                - icon_hue

          - type: conditional
            conditions:
              - entity: input_select.selectable_room
                state: Living Room And Kitchen
            card:
              type: custom:button-card
              entity: light.living_room_and_kitchen_lights
              template:
                - light
                - icon_hue

          - type: conditional
            conditions:
              - entity: input_select.selectable_room
                state: Bedroom
            card:
              type: custom:button-card
              entity: light.bedroom_lights
              template:
                - light
                - icon_hue
                
                
      # Conditional: Selectable Light

          # - type: conditional
          #   conditions:
          #     - entity: input_select.selectable_light
          #       state: Chandelier
          #   card:
          #     type: custom:button-card
          #     entity: light.chandelier
          #     tap_action:
          #       action: none
          #     template:
          #       - light
          #       - icon_hue

          # - type: conditional
          #   conditions:
          #     - entity: input_select.selectable_light
          #       state: TV
          #   card:
          #     type: custom:button-card
          #     entity: light.tv
          #     template:
          #       - light
          #       - icon_hue

          # - type: conditional
          #   conditions:
          #     - entity: input_select.selectable_light
          #       state: Kitchen East
          #   card:
          #     type: custom:button-card
          #     entity: light.kitchen_east
          #     template:
          #       - light
          #       - icon_hue

          # - type: conditional
          #   conditions:
          #     - entity: input_select.selectable_light
          #       state: Kitchen West
          #   card:
          #     type: custom:button-card
          #     entity: light.kitchen_west
          #     template:
          #       - light
          #       - icon_hue

          # - type: conditional
          #   conditions:
          #     - entity: input_select.selectable_light
          #       state: Bedroom
          #   card:
          #     type: custom:button-card
          #     entity: light.bedroom
          #     template:
          #       - light
          #       - icon_hue
                
          # - type: conditional
          #   conditions:
          #     - entity: input_select.selectable_light
          #       state: Bed
          #   card:
          #     type: custom:button-card
          #     entity: light.bed
          #     template:
          #       - light
          #       - icon_hue
                
          # - type: conditional
          #   conditions:
          #     - entity: input_select.selectable_light
          #       state: Hallway
          #   card:
          #     type: custom:button-card
          #     entity: light.hallway
          #     template:
          #       - light
          #       - icon_hue
                
          # - type: conditional
          #   conditions:
          #     - entity: input_select.selectable_light
          #       state: Bathroom
          #   card:
          #     type: custom:button-card
          #     entity: light.bathroom
          #     template:
          #       - light
          #       - icon_hue
            

          - type: grid
            cards:
              # - type: button
              #   icon: mdi:cctv
              #   # tap_action: !include popup/sidebar_vacuum.yaml
              #   tap_action:
              #     action: navigate
              #     navigation_path: /ccab4aaf_frigate/dashboard
              #   hold_action:
              #     action: none

              # - type: button
              #   icon: mdi:cctv
              #   tap_action:
              #     action: fire-dom-event
              #     browser_mod:
              #       command: popup
              #       title: Frigate
              #       style: >
              #         :host .content {
              #           width: 75em;
              #         }
              #       card:
              #         type: iframe
              #         url: /ccab4aaf_frigate/dashboard
              #         aspect_ratio: 65%
              #         style: |
              #           ha-card {
              #             border-radius: 0 0 1em 1em;
              #           }
              #   hold_action:
              #     action: none
                  
              - type: button
                icon: mdi:cctv
                tap_action: !include popup/sidebar_security.yaml
                hold_action:
                  action: none

              - type: button
                icon: mdi:information-outline
                tap_action: !include popup/sidebar_information.yaml
                hold_action:
                  action: none

              - type: button
                icon: mdi:arrow-up-bold-circle-outline
                tap_action: !include popup/sidebar_update.yaml
                # tap_action:
                #   action: call-service
                #   service: frontend.reload_themes
                
                # hold_action:
                #   action: call-service
                #   service: homeassistant.update_entity
                #   service_data:
                #     entity_id: sensor.hacs

      #################################################
      #                                               #
      #                  Living Room                  #
      #                                               #
      #################################################

      - type: grid
        title: Living Room
        view_layout:
          grid-area: livingroom
        columns: 2
        cards:
          - type: custom:button-card
            entity: light.living_room_lights #living_room_lights
            name: Lights
            template:
              - light
              - icon_hue

          - type: custom:button-card
            entity: light.tv
            name: TV Light
            template:
              - light
              - icon_tv

          - type: custom:button-card
            entity: media_player.living_room_chromecast
            name: TV
            state_display: >
              [[[
                if (variables.state == 'playing') {
                  return 'On';
                }
              ]]]
            hold_action: !include popup/vardagsrum_tv.yaml
            template:
              - base
              - icon_tv
              - loader

          - type: custom:button-card
            entity: switch.kettle
            name: Kettle
            hold_action: !include popup/vardagsrum_balkong.yaml
            template:
              - base
              - icon_hue
              - loader

      #################################################
      #                                               #
      #                    Kitchen                    #
      #                                               #
      #################################################

      - type: grid
        title: Kitchen
        view_layout:
          grid-area: kitchen
        columns: 2
        cards:
          - type: custom:button-card
            entity: light.kitchen_lights
            name: Spotlights
            template:
              - light
              - icon_hue

          - type: custom:button-card
            entity: light.kitchen_west
            name: Kitchen (Left)
            template:
              - light
              - icon_spot

          - type: custom:button-card
            entity: light.kitchen_east
            name: Kitchen (Right)
            template:
              - light
              - icon_spot

          - type: custom:button-card
            entity: switch.kettle
            name: Kettle
            triggers_update:
              - lock.dator
              - script.home_leave
            hold_action: !include popup/studio_dator.yaml
            template:
              - base
              - icon_imac
              - loader
              - lock

          # - type: custom:button-card
          #   entity: switch.wemo_monitors
          #   name: Monitorer
          #   triggers_update: sensor.monitors_volume
          #   hold_action: !include popup/studio_monitorer.yaml
          #   template:
          #     - base
          #     - icon_monitors
          #     - circle
          #     - loader
          #   variables:
          #     circle_input: >
          #       [[[
          #         var entity_id = 'sensor.monitors_volume';
          #         return states[entity_id] === undefined ? null : states[entity_id].state;
          #       ]]]

      #################################################
      #                                               #
      #                    BEDROOM                    #
      #                                               #
      #################################################

      - type: grid
        title: Bedroom
        view_layout:
          grid-area: bedroom
        columns: 2
        cards:
          - type: custom:button-card
            entity: light.bedroom
            name: Bedroom
            template:
              - light
              - icon_lamp

          - type: custom:button-card
            entity: light.bed
            name: Bed LEDs
            template:
              - light
              - icon_lamp

          # - type: custom:button-card
          #   entity: climate.ac
          #   name: Klimat
          #   hold_action: !include popup/sovrum_klimat.yaml
          #   template:
          #     - base
          #     - icon_climate
          #     - climate
          #   variables:
          #     circle_input: >
          #       [[[
          #         if (entity) {
          #           return entity.state == 'cool' ?
          #             entity.attributes.temperature :
          #             entity.attributes.current_temperature;
          #         }
          #       # ]]]

          - type: custom:button-card
            entity: media_player.bedroom_tv
            name: "TV\u00B2"
            # hold_action: !include popup/vardagsrum_playstation.yaml
            hold_action: !include popup/sovrum_tv2.yaml
            template:
              - base
              - icon_tv
              - loader

          - type: custom:button-card
            entity: switch.bedroom_monitor
            name: "TV\u00B2"
            hold_action: !include popup/sovrum_tv2.yaml
            template:
              - base
              - icon_tv
              - loader

      #################################################
      #                                               #
      #                     MEDIA                     #
      #                                               #
      #################################################

      - type: grid
        title: Media
        view_layout:
          grid-area: media
        columns: 1
        cards:
          # - type: custom:mod-card
          #   style:
          #     swipe-card:
          #       $: |
          #         .swiper-container {
          #           padding: 0px 0px 20px 0px !important;
          #         }
          - type: "custom:swipe-card"
            start_card: 1
            parameters:
              roundLengths: true
              effect: coverflow
              speed: 650
              spaceBetween: 20
              threshold: 7
              coverflowEffect:
                rotate: 80
                depth: 300
            cards:
              - type: grid
                columns: 2
                cards:
                  - type: custom:button-card
                    entity: media_player.living_room_chromecast
                    name: Living Room TV
                    template:
                      - media
                      - icon_tv

                  - type: custom:button-card
                    entity: media_player.living_room_speaker
                    name: Living Room Speaker
                    template:
                      - media
                      - icon_nest_mini

                  - type: custom:button-card
                    name: Bedroom TV
                    entity: media_player.bedroom_tv
                    template:
                      - media
                      - icon_tv

                  - type: custom:button-card
                    entity: media_player.bedroom_speaker
                    name: Bedroom Speaker
                    template:
                      - media
                      - icon_nest_mini

                  # - type: custom:button-card
                  #   entity: media_player.spotify_dave_lambe
                  #   name: Spotify
                  #   template:
                  #     - media
                  #     - icon_spotify

                  # - type: custom:button-card
                  #   entity: media_player.wall_speaker
                  #   name: Wall Speaker
                  #   template:
                  #     - media
                  #     - icon_nest_mini

              - type: horizontal-stack
                cards:
                  - type: conditional
                    conditions:
                      - entity: input_select.conditional_media
                        state: Living Room TV
                    card:
                      type: custom:button-card
                      entity: media_player.living_room_chromecast
                      template:
                        - conditional_media
                        - icon_tv

                  - type: conditional
                    conditions:
                      - entity: input_select.conditional_media
                        state: Living Room Speaker
                    card:
                      type: custom:button-card
                      entity: media_player.living_room_speaker
                      template:
                        - conditional_media
                        - icon_nest_mini

                  - type: conditional
                    conditions:
                      - entity: input_select.conditional_media
                        state: Bedroom TV
                    card:
                      type: custom:button-card
                      entity: media_player.bedroom_tv
                      template:
                        - conditional_media
                        - icon_tv

                  - type: conditional
                    conditions:
                      - entity: input_select.conditional_media
                        state: Bedroom Speaker
                    card:
                      type: custom:button-card
                      entity: media_player.bedroom_speaker
                      template:
                        - conditional_media
                        - icon_nest_mini

                  - type: conditional
                    conditions:
                      - entity: input_select.conditional_media
                        state: Wall Speaker
                    card:
                      type: custom:button-card
                      entity: media_player.wall_speaker
                      template:
                        - conditional_media
                        - icon_nest_mini

                  - type: conditional
                    conditions:
                      - entity: input_select.conditional_media
                        state: Spotify
                    card:
                      type: custom:button-card
                      entity: media_player.spotify_dave_lambe
                      template:
                        - conditional_media
                        - icon_spotify

                  - type: conditional
                    conditions:
                      - entity: input_select.conditional_media
                        state: Last Downloaded
                    card:
                      type: custom:button-card
                      entity: sensor.plex_recently_added
                      tap_action:
                        action: none
                      template:
                        - conditional_media
                        - recently_downloaded
                        - icon_plex

      #################################################
      #                                               #
      #                    OTHER                      #
      #                                               #
      #################################################

      - type: grid
        title: Other
        view_layout:
          grid-area: other
        columns: 2
        cards:
          - type: custom:button-card
            entity: light.bathroom
            name: Bathroom
            template:
              - light
              - icon_bathroom

          - type: custom:button-card
            # entity: fan.studio_wemo
            entity: switch.fan
            name: "Fan\u00B2"
            hold_action: !include popup/studio_flakt.yaml
            template:
              - base
              - icon_fan2
              - loader

          - type: custom:button-card
            entity: light.hallway
            name: Hallway
            template:
              - light
              - icon_closet

          - type: custom:button-card
            entity: light.closet
            name: Closet
            template:
              - light
              - icon_spot

      #################################################
      #                                               #
      #                     HOME                      #
      #                                               #
      #################################################

      - type: grid
        title: Home
        view_layout:
          grid-area: home
        columns: 2
        cards:
          - type: custom:button-card
            entity: person.dave
            name: Dave
            triggers_update:
              - device_tracker.davecom
            tap_action: !include popup/person_dave.yaml
            hold_action:
              action: none
            variables:
              retain: sensor.sanja_last_changed
            template: person

          - type: custom:button-card
            entity: person.ebony
            name: Ebony
            triggers_update:
              - device_tracker.ebonycom
            tap_action: !include popup/hemma_sanja.yaml
            hold_action:
              action: none
            variables:
              retain: sensor.sanja_last_changed
            template: person

          # - type: custom:button-card
          #   entity: light.all_lights
          #   name: All Lights
          #   template:
          #     - light
          #     - icon_hue

          # - type: custom:button-card
          #   entity: >
          #     [[[
          #       let entity_id = 'input_select.selectable_room';
          #       let room_light = 'light.' + states[entity_id].state.toLowerCase().replace(/ /g, "_") + '_lights';
          #       return states[room_light].entity_id;
          #     ]]]
          #   name: >
          #     [[[
          #       var entity_id = 'input_select.selectable_room';
          #       return states[entity_id] === undefined ? 'Fail' : states[entity_id].state + ' Lights';
          #     ]]]
          #   template:
          #     - light
          #     - icon_hue
          
          # # Conditional: Selectable Room
              
          # - type: horizontal-stack
          #   cards:

          #     - type: conditional
          #       conditions:
          #         - entity: input_select.selectable_room
          #           state: All
          #       card:
          #         type: custom:button-card
          #         entity: light.all_lights
          #         tap_action:
          #           action: none
          #         template:
          #           - light
          #           - icon_hue

          #     - type: conditional
          #       conditions:
          #         - entity: input_select.selectable_room
          #           state: Living Room
          #       card:
          #         type: custom:button-card
          #         entity: light.living_room_lights
          #         template:
          #           - light
          #           - icon_hue

          #     - type: conditional
          #       conditions:
          #         - entity: input_select.selectable_room
          #           state: Kitchen
          #       card:
          #         type: custom:button-card
          #         entity: light.kitchen_lights
          #         template:
          #           - light
          #           - icon_hue

          #     - type: conditional
          #       conditions:
          #         - entity: input_select.selectable_room
          #           state: Living Room And Kitchen
          #       card:
          #         type: custom:button-card
          #         entity: light.living_room_and_kitchen_lights
          #         template:
          #           - light
          #           - icon_hue

          #     - type: conditional
          #       conditions:
          #         - entity: input_select.selectable_room
          #           state: Bedroom
          #       card:
          #         type: custom:button-card
          #         entity: light.bedroom_lights
          #         template:
          #           - light
          #           - icon_hue
                    
          # # Conditional: Selectable Light
                    
          # - type: horizontal-stack
          #   cards:

          #     - type: conditional
          #       conditions:
          #         - entity: input_select.selectable_light
          #           state: Chandelier
          #       card:
          #         type: custom:button-card
          #         entity: light.chandelier
          #         tap_action:
          #           action: none
          #         template:
          #           - light
          #           - icon_hue

          #     - type: conditional
          #       conditions:
          #         - entity: input_select.selectable_light
          #           state: TV
          #       card:
          #         type: custom:button-card
          #         entity: light.tv
          #         template:
          #           - light
          #           - icon_hue

          #     - type: conditional
          #       conditions:
          #         - entity: input_select.selectable_light
          #           state: Kitchen East
          #       card:
          #         type: custom:button-card
          #         entity: light.kitchen_east
          #         template:
          #           - light
          #           - icon_hue

          #     - type: conditional
          #       conditions:
          #         - entity: input_select.selectable_light
          #           state: Kitchen West
          #       card:
          #         type: custom:button-card
          #         entity: light.kitchen_west
          #         template:
          #           - light
          #           - icon_hue

          #     - type: conditional
          #       conditions:
          #         - entity: input_select.selectable_light
          #           state: Bedroom
          #       card:
          #         type: custom:button-card
          #         entity: light.bedroom
          #         template:
          #           - light
          #           - icon_hue
                    
          #     - type: conditional
          #       conditions:
          #         - entity: input_select.selectable_light
          #           state: Bed
          #       card:
          #         type: custom:button-card
          #         entity: light.bed
          #         template:
          #           - light
          #           - icon_hue
                    
          #     - type: conditional
          #       conditions:
          #         - entity: input_select.selectable_light
          #           state: Hallway
          #       card:
          #         type: custom:button-card
          #         entity: light.hallway
          #         template:
          #           - light
          #           - icon_hue
                    
          #     - type: conditional
          #       conditions:
          #         - entity: input_select.selectable_light
          #           state: Bathroom
          #       card:
          #         type: custom:button-card
          #         entity: light.bathroom
          #         template:
          #           - light
          #           - icon_hue
              
              
          # let room = states[input_select.selectable_room].state.toLowerCase().replace(/ /g, "_");
          # return 'light.' + room + '_lights';

          # - type: custom:button-card
          #   entity: script.goodnight
          #   name: Goodnight
          #   hold_action:
          #     action: none
          #   template:
          #     - base
          #     - icon_home
              
              

          # - type: custom:button-card
          #   entity: script.home_leave
          #   name: Stäng allt
          #   hold_action:
          #     action: none
          #   template:
          #     - base
          #     - icon_away

          # - type: custom:button-card
          #   entity: script.morning
          #   name: Morning
          #   hold_action:
          #     action: none
          #   template:
          #     - base
          #     - icon_away

          # - type: button
            # entity: group.selected_room_lights
            # name: Cameras
            # tap_action: !include popup/frigate_cards.yaml
            # template:
            #   - light
              # - icon_hue

      #################################################
      #                                               #
      #                    FOOTER                     #
      #                                               #
      #################################################

      - type: custom:button-card
        view_layout:
          grid-area: footer
        entity: sensor.time
        template: coronavirus
